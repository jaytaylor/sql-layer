PhysicalSelect[cid:int[INT]]
  Map_NestedLoops()
    AncestorLookup_Default(Index(parent.PRIMARY) -> parent)
      IndexScan_Default(Index(parent.PRIMARY), id > 1)
    Project_Default(customers.cid)
      Product_NestedLoops(customers - items x customers - addresses)
        Flatten_HKeyOrdered(customers INNER items)
          Select_HKeyOrdered(items.quan > 100)
            AncestorLookup_Default(Index(customers.cname_and_sku) -> customers, items)
              IndexScan_Default(Index(customers.cname_and_sku), customers.name = parent.name, items.sku = '1234')
        Select_HKeyOrdered(addresses.city != customers.name)
          Filter_Default(customers - addresses)
            Flatten_HKeyOrdered(customers INNER addresses)
              Select_HKeyOrdered(parent.state == addresses.state)
                BranchLookup_Nested(customers -> addresses)
